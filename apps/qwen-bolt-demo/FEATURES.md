# Qwen Coder 功能文档

## 产品概述

**Qwen Coder** 是一个基于 Qwen Code SDK 的 AI 代码生成工具，通过自然语言对话即可快速创建应用和网站。

---

## 核心功能

### 1. 首页（Landing Page）

#### 1.1 品牌展示
- **产品名称**：Qwen Coder
- **品牌图标**：代码符号 `</>`（蓝色渐变）
- **版本标识**：显示 "Powered by Qwen Code SDK"

#### 1.2 主输入区域
**功能描述**：用户可以通过自然语言描述想要创建的应用

**界面元素**：
- **主标题**：What will you **build** today?
- **副标题**：Create stunning apps & websites by chatting with AI.
- **多行文本输入框**：
  - 占位符文本：`Let's build a dashboard to track K...`
  - 支持多行输入
  - 支持 Enter 键快捷提交（Shift+Enter 换行）

#### 1.3 工具栏功能

**模型选择器**：
- 显示当前使用的 AI 模型（如 Sonnet 4.5）
- 下拉菜单可切换不同模型
- 图标：代码符号 `</>`

**附件上传**：
- 支持上传文件作为上下文
- 图标：回形针 📎

**构建按钮**：
- 文案：`Build now →`
- 蓝色渐变背景（from-blue-500 to-cyan-500）
- 带阴影效果
- 禁用状态：输入为空时不可点击

#### 1.4 导入选项
**支持的导入源**：
- **Figma**：从 Figma 设计稿导入
- **GitHub**：从 GitHub 仓库导入

**显示方式**：
```
or import from Figma / GitHub
```

#### 1.5 顶部导航栏
**导航菜单**：
- Community（社区）
- Enterprise（企业版）
- Resources（资源）
- Careers（招聘）
- Pricing（定价）
- Sign in（登录按钮）

---

### 2. 工作区页面（Workspace）

#### 2.1 三栏布局

**左侧：对话面板**
- 宽度：384px（w-96）
- 显示用户和 AI 的对话历史
- 支持实时流式响应
- 消息自动滚动到底部
- 支持长文本自动换行（break-words）

**中间：代码编辑器**
- 文件树导航
- 代码编辑器（CodeMirror）
- 语法高亮
- 只读模式（可配置）
- 支持多文件切换

**右侧：实时预览**
- 宽度：1/3 屏幕
- iframe 预览
- 自动刷新
- 支持新窗口打开

#### 2.2 左侧对话面板功能

**顶部工具栏**：
- 品牌标识：Qwen Coder + 图标
- 关闭按钮

**消息显示**：
- **用户消息**：蓝色气泡，右对齐
- **AI 消息**：灰色气泡，左对齐
- **流式响应**：显示 "Typing..." 动画

**输入区域**：
- 多行文本框（2行）
- 占位符：`What would you like to build today?`
- 发送按钮（Send 图标）
- 支持 Enter 快捷键发送
- 支持 Shift+Enter 换行

#### 2.3 中间代码编辑器功能

**文件树**：
- 显示所有生成的文件和目录
- 文件夹可展开/折叠
- 文件图标根据类型显示
- 当前文件高亮显示
- **下载按钮**：📥 图标，可下载整个项目为 ZIP

**代码编辑器**：
- 基于 CodeMirror 6
- 支持多种语言：
  - JavaScript/TypeScript
  - Python
  - Markdown
  - HTML/CSS
- OneDark 主题
- 行号显示
- 语法高亮
- 代码折叠

**顶部工具栏**：
- 文件树折叠/展开按钮
- 当前文件名显示

#### 2.4 右侧预览面板功能

**顶部工具栏**：
- 标题：Preview
- 框架标识：显示项目类型和端口（如 "React • Port 5174"）
- **Start Preview 按钮**：
  - 自动检测项目类型
  - 安装依赖
  - 启动开发服务器
  - 显示加载状态
- **刷新按钮**：重新加载预览
- **新窗口打开按钮**：在新标签页打开预览

**预览区域**：
- iframe 嵌入
- 实时显示应用运行效果
- 支持交互操作
- 沙箱模式（allow-scripts, allow-same-origin 等）

**空状态**：
- 显示代码图标
- 提示文本：
  - "No Preview Available"
  - "Start chatting with AI to generate your app"

---

### 3. 技术特性

#### 3.1 AI 对话功能
- **流式响应**：实时显示 AI 生成的内容
- **上下文保持**：记住对话历史
- **工具调用**：AI 可以自动创建、编辑文件
- **错误处理**：显示友好的错误提示

#### 3.2 文件管理
- **自动创建**：AI 自动生成项目文件
- **实时更新**：文件变更立即反映在编辑器中
- **文件下载**：一键下载整个项目
- **会话隔离**：每个会话独立的工作目录

#### 3.3 开发服务器
- **智能检测**：自动识别项目类型（React、Vue、Vite、静态 HTML）
- **自动安装**：自动运行 `npm install`
- **端口管理**：智能查找可用端口
- **多框架支持**：
  - Create React App
  - Vite
  - Vue CLI
  - 静态 HTML

#### 3.4 预览功能
- **实时预览**：代码变更自动刷新
- **热重载**：支持开发服务器的热重载
- **错误显示**：显示启动失败的错误信息
- **超时保护**：2 分钟超时机制

---

### 4. 用户体验特性

#### 4.1 视觉设计
- **深色主题**：黑色背景，减少眼睛疲劳
- **渐变效果**：蓝色到青色的品牌渐变
- **地球光晕**：首页背景的视觉效果
- **毛玻璃效果**：导航栏的 backdrop-blur

#### 4.2 交互反馈
- **加载状态**：显示加载动画
- **悬停效果**：按钮悬停变色
- **禁用状态**：不可用时显示灰色
- **过渡动画**：平滑的状态切换

#### 4.3 响应式设计
- **自适应布局**：支持不同屏幕尺寸
- **文本换行**：长文本自动换行
- **滚动优化**：消息自动滚动到底部

---

### 5. 快捷键

| 快捷键 | 功能 |
|--------|------|
| `Enter` | 发送消息 |
| `Shift + Enter` | 换行 |
| `Cmd/Ctrl + Shift + R` | 强制刷新页面 |

---

### 6. 支持的项目类型

| 项目类型 | 检测依据 | 启动命令 |
|----------|----------|----------|
| React (CRA) | `react` + `react-scripts` | `npm start` |
| React (Vite) | `react` + `vite` | `npm run dev` |
| Vue | `vue` | `npm run dev` |
| Vite | `vite` | `npm run dev` |
| 静态 HTML | 无 package.json | 直接预览 |

---

### 7. 文件下载功能

**功能描述**：将生成的项目打包成 ZIP 文件下载

**使用方式**：
1. 点击文件树顶部的下载图标（📥）
2. 自动打包所有文件（跳过 node_modules 和隐藏文件）
3. 浏览器自动下载 `project-{sessionId}.zip`

**技术实现**：
- 使用 JSZip 库打包
- DEFLATE 压缩算法（级别 9）
- 递归读取所有文件
- 自动过滤不必要的文件

---

### 8. 错误处理

**常见错误及处理**：
- **端口被占用**：自动查找下一个可用端口
- **依赖安装失败**：显示详细错误信息
- **服务器启动超时**：2 分钟后自动取消
- **文件读取失败**：显示友好提示

---

### 9. 技术栈

**前端框架**：
- Next.js 15.1.4
- React 19.0.0
- TypeScript

**UI 组件**：
- Tailwind CSS
- Lucide React（图标）
- CodeMirror 6（代码编辑器）

**后端**：
- Node.js
- Express（自定义服务器）
- Socket.IO（WebSocket 通信）

**AI SDK**：
- @qwen-code/sdk 0.1.1

**工具库**：
- JSZip（文件打包）
- http-proxy（代理）

---

### 10. 使用流程

#### 10.1 快速开始
1. 访问首页
2. 在输入框中描述想要创建的应用
3. 点击 "Build now" 按钮
4. 等待 AI 生成代码
5. 点击 "Start Preview" 查看效果
6. 下载项目到本地

#### 10.2 典型场景

**场景 1：创建简单网页**
```
用户输入：帮我写一个 hello 的 html 文件
AI 生成：hello.html
预览：直接显示 HTML 页面
```

**场景 2：创建 React 应用**
```
用户输入：创建一个 React 待办事项应用
AI 生成：完整的 React 项目结构
预览：自动启动开发服务器，显示应用
```

**场景 3：修改现有代码**
```
用户输入：把标题改成红色
AI 修改：更新 CSS 文件
预览：自动刷新显示新效果
```

---

### 11. 限制和注意事项

1. **临时存储**：生成的文件存储在临时目录，定期清理
2. **会话隔离**：每个会话独立，不共享文件
3. **网络依赖**：需要网络连接来调用 AI 和安装依赖
4. **端口限制**：开发服务器端口从 5173 开始自动分配
5. **文件大小**：大型项目可能需要较长的生成和安装时间

---

### 12. 未来规划

- [ ] 支持更多 AI 模型
- [ ] 支持 Git 集成
- [ ] 支持团队协作
- [ ] 支持项目模板
- [ ] 支持部署到云平台
- [ ] 支持代码版本历史
- [ ] 支持多语言界面

---

## 总结

Qwen Coder 是一个功能完整的 AI 代码生成工具，通过简单的自然语言对话即可快速创建和预览应用。它结合了强大的 AI 能力、友好的用户界面和完善的开发工具，为用户提供了从想法到实现的无缝体验。
